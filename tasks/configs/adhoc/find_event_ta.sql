-- =================================================================================
-- 模板说明：用于快速定位 ID 所属事件的查询脚本
-- 核心功能：通过排除高频且无关的日志事件（如点击、启动、战斗等），精准获取道具产出和活动相关的日志。
-- =================================================================================

SELECT 
    "#user_id",
    "#event_name",
    "#event_time",
    "#account_id",
    "#server_time",
    "gid",
    "#data_source",
    "time_server",
    "free_stamps",
    "level",
    "channel",
    "first_role",
    "lsid",
    "role_name",
    "diamond",
    "money",
    "stamps",
    "task_id",
    "task_type",
    "method",
    "achieve_list",
    "report_id",
    "send_level",
    "a_rst",
    "fortune_player",
    "card_id",
    "relation",
    "tourist_match_score",
    "tourist_shoot_times",
    "tourist_self_score",
    "tourist_match_time",
    "reason",
    "base_score",
    "extra_score",
    "credit_type",
    "pvp_type",
    "level_before",
    "level_after",
    "battle_num",
    "battle_type",
    "awaken_level",
    "target_id_list",
    "team_id",
    "teammate_id",
    "rank",
    "season",
    "surrender",
    "talent_rate",
    "guild_id",
    "pvp_session",
    "time",
    "is_oppreal",
    "type",
    "session",
    "result",
    "card_level",
    "player_id",
    "map",
    "skill_sum",
    "user_level",
    "match_star",
    "stage_id",
    "adventure_id",
    "target_data",
    "target_type",
    "target_id",
    "luck",
    "draw_times",
    "draw_table_id",
    "free",
    "active_id",
    "active_type",
    "reward_lv",
    "chapter_id",
    "item_id",
    "gift_id",
    "deal_type",
    "achievement_id",
    "achievement_type",
    "achievement_level",
    "subtype",
    "pay_amount_usd",
    "pay_currency",
    "product_id",
    "pay_type",
    "pay_amount",
    "cfg_id",
    "store_type",
    "goods_money",
    "order_id",
    "daily_type",
    "task_ids",
    "open_reward",
    "activity_type",
    "activity_id",
    "training_day",
    "traing_point",
    "rateopp_camp_total",
    "defence_plan",
    "rank_camp",
    "play_switch",
    "attack_plan",
    "play_cont",
    "play_trust",
    "playeropp_id_list",
    "player_id_list",
    "camp_sum",
    "rate_camp_total",
    "story_id",
    "title",
    "kana_title_id",
    "kana_task_id",
    "unlock_card",
    "skill_id",
    "skin_id",
    "reward_index",
    "shop_item",
    "favor_level",
    "select_ops",
    "match_result",
    "afk",
    "stage_player_id",
    "cost_time",
    "guild_name",
    "is_week",
    "plan_idx",
    "potential_total",
    "potential",
    "potency_times",
    "potency_gacha_id",
    "isfress",
    "potency_gacha_type",
    "battlepass_base",
    "battlepass_advance",
    "week_id",
    "battle_pass_index",
    "index",
    "spring_gacha_times",
    "spring_gacha_type",
    "spring_gacha_id",
    "prestige_level_after",
    "prestige_level_before",
    "player_send_list",
    "is_extra",
    "is_special",
    "awaken_skill_level",
    "awaken_skill_id",
    "is_crossserver",
    "team_gids",
    "match_cup",
    "cancel_match_time",
    "code",
    "bath_id",
    "block_score",
    "block_comboo",
    "block_team",
    "success_num",
    "block_result",
    "block_rate",
    "block_mode",
    "prestige_answer_result",
    "prestige_answer_id",
    "icon_id",
    "icon_type",
    "lid",
    "potential_num",
    "lbs_pos",
    "privacy",
    "num",
    "complain_type",
    "detail",
    "reward_level",
    "battlepass_type",
    "err_index",
    "prestige_level",
    "install_time",
    "media_source",
    "te_ads_object",
    "advertising_id",
    "event_source",
    "bundle_id",
    "event_name",
    "customer_user_id",
    "campaign",
    "battle_sum",
    "is_sync",
    "server_version",
    "charge_region",
    "charge_type",
    "sandbox",
    "guide_battle_number",
    "guide_battle_time",
    "guide_battle_id",
    "is_finish",
    "total_diamond_collect",
    "reward_day",
    "return_sigh_day",
    "sign_day_total",
    "player_select",
    "battlepass_id",
    "trial_task",
    "battlepass_levelup_after",
    "battlepass_levelup_before",
    "common_agetrialtask_ids",
    "is_cardbuy",
    "up_agetrialtask_ids",
    "guildbless_type",
    "blesspoint_single",
    "blesspoint_guild",
    "guildbless_stage",
    "team_name",
    "team_point_single",
    "team_point",
    "season_activepointget",
    "season_activepoint",
    "season_challengepoint",
    "season_challengepointget",
    "squad_id",
    "de_apply",
    "de_deal",
    "seasonaward_type",
    "season_point",
    "starpoint_single",
    "rate_star_total",
    "starpoint_total",
    "is_mop",
    "starpoint_guild",
    "star_type",
    "box_id",
    "box_type",
    "boxlevel",
    "flip_stage",
    "flip_total",
    "day_ids",
    "ball_durable",
    "ball_headword",
    "ball_number",
    "ball_score",
    "ball_quality",
    "ball_attribute",
    "transaction_id",
    "trading_item_type",
    "transaction_price",
    "transaction_times",
    "reward_id",
    "is_auto",
    "mail_order_id",
    "guild_race_person_score_total",
    "guild_race_group_score",
    "guild_race_person_score",
    "guild_race_person_type",
    "new_ball_number",
    "new_ball_scoreafter",
    "ball_inherit_attribute",
    "old_ball_score",
    "old_ball_quality",
    "new_ball_quality",
    "old_ball_number",
    "new_ball_scorebefore",
    "new_ball_headword",
    "ball_scorebefore",
    "ball_scoreafter",
    "reinforce_attribute",
    "ball_durable_before",
    "ball_durable_after",
    "ballbox_id",
    "ball_fix_before",
    "ball_fix_after",
    "sell_gid",
    "is_freebuy",
    "targetuser_id",
    "card_num",
    "guildprayaward_index",
    "guildpray_point",
    "card_ids",
    "card_numtotal",
    "chaingift_id",
    "guild_jackpot_id",
    "guild_wingames",
    "single_wingames",
    "single_rank",
    "pray_index",
    "reward_type",
    "bind_type",
    "mail_cfg_id",
    "chg_times",
    "old_attr",
    "new_attr",
    "reset_id_list",
    "reset_num",
    "retargeting_conversion_type",
    "area_id",
    "is_inherit",
    "area_score",
    "season_id",
    "attribute_id",
    "skill_equip",
    "use_time",
    "attribute_before",
    "attribute_after",
    "repair",
    "level_type",
    "de_dealnew",
    "de_dealex",
    "de_applynew",
    "device_type",
    "device_os",
    "reward_list",
    "score_max",
    "item_rest",
    "buy_id",
    "reward_first",
    "reward_last",
    "branch_stage_id",
    "use_itemnew",
    "box_list",
    "daily_type_new",
    "lock_before",
    "lock_after",
    "$part_event",
    "$part_date"
FROM ta.v_event_9
WHERE "$part_date" >= '2026-02-04'                      -- 设置查询开始日期
  AND "$part_date" <= '2026-02-06'                      -- 设置查询结束日期

-- 【关键：屏蔽列表】排除掉异常高频、下载量巨大且通常与道具产出无关的事件
AND "$part_event" NOT IN (
    'button_click',          -- 按钮点击
    'friend_gift',           -- 好友赠礼
    'summary_login',         -- 登录汇总
    'player_activity',       -- 会话活跃
    'login',                -- 登录
    'gamer_guide',          -- 新手引导
    'trust_camp_result',    -- 模型结果
    'match_start',          -- 匹配开始
    'pvp_info',             -- PVP信息
    'battle_result',        -- 战斗结果
    'vsloading',            -- 加载界面
    'fight_data',           -- 战斗数据
    'player_send_refresh',  -- 刷新分发
    'card_skillrune',       -- 技能符文
    'gin_monopoly_roll',    -- 大富翁掷骰
    'sign',                 -- 签到
    'change_name'           -- 改名
)

-- 精确过滤时间段（可选）
AND "#event_time" >= timestamp '2026-02-04 11:00:00' 
AND "#event_time" <= timestamp '2026-02-06 18:00:00'
